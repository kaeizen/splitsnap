<nz-list nzSize="small">
	@for (expense of expenses(); track expense.id) {
		<nz-list-item>
			<nz-collapse [nzBordered]="false" >
				<nz-collapse-panel [nzHeader]="expense.description" [nzExtra]="extraTpl">
					<div nz-flex [nzVertical]="true" >
						<p style="margin-bottom: 0;">{{ expense.date | date:'MMMM d, yyyy' }}</p>
						<nz-table nzTemplateMode>
							<thead>
								<tr>
									<th>Members</th>
									<th>Amount to pay</th>
									<th>Amount paid</th>
								</tr>
							</thead>
							<tbody>
								@for ( member of expense.membersToPay | keyvalue; track member.key) {
									<tr>
										<td>{{ member.value.name }}</td>
										<td><span nzInputPrefix>₱</span> {{ member.value.amount | number:'1.2-2' }}</td>
										<td><span nzInputPrefix>₱</span> {{ ( member.key in expense.membersPaid ? expense.membersPaid[member.key].amount : 0 ) | number:'1.2-2' }}</td>
									</tr>
								}
								@for ( member of expense.membersPaid | keyvalue; track member.key) {
									@if ( ! ( member.key in expense.membersToPay ) ) {
										<tr>
											<td>{{ member.value.name }}</td>
											<td><span nzInputPrefix>₱</span> {{ 0 | number:'1.2-2' }}</td>
											<td><span nzInputPrefix>₱</span> {{ ( member.value.amount ) | number:'1.2-2' }}</td>
										</tr>
									}
								}
							</tbody>
						</nz-table>
					</div>
				</nz-collapse-panel>
			</nz-collapse>
		</nz-list-item>
		<ng-template #extraTpl>
			<div nz-flex [nzGap]="4" nzAlign="center" (click)="$event.stopPropagation()">
			   <span><span nzInputPrefix>₱</span> {{ expense.amount | number:'1.2-2' }}</span>
			   <a nz-dropdown nzTrigger="click" [nzDropdownMenu]="menu">
				   <nz-icon nzType="more" nzTheme="outline" />
			   </a>
		   </div>
	   </ng-template>
	   <nz-dropdown-menu #menu="nzDropdownMenu">
		<ul nz-menu>
			<!-- <li nz-menu-item>Edit</li> -->
			<li nz-menu-item (click)="deleteExpense(expense.id)">Delete</li>
		</ul>
	</nz-dropdown-menu>
	}
</nz-list>


